"""
Edwards analog output voltage to pressure conversion.
"""

import numpy as np

########################################
# Analog output to pressure conversion #
########################################

_apg_m_p = np.array(
    [
        1e-05,
        0.000231,
        0.000621,
        0.00136,
        0.00297,
        0.00461,
        0.00651,
        0.0102,
        0.0147,
        0.0191,
        0.0295,
        0.0416,
        0.0561,
        0.072,
        0.0894,
        0.113,
        0.145,
        0.176,
        0.222,
        0.316,
        0.413,
        0.54,
        0.682,
        0.841,
        1.06,
        1.33,
        1.6,
        1.87,
        2.26,
        2.75,
        3.24,
        3.73,
        4.39,
        5.29,
        6.27,
        7.63,
        9.39,
        12.7,
        16.7,
        22.4,
        28.8,
        35.3,
        44.8,
        66.5,
        141.0,
        616.0,
        1000.0,
    ]
)

_apg_m_v = np.array(
    [
        2.0,
        2.05,
        2.1,
        2.2,
        2.4,
        2.6,
        2.8,
        3.0,
        3.2,
        3.4,
        3.6,
        3.8,
        4.0,
        4.2,
        4.4,
        4.6,
        4.8,
        5.0,
        5.2,
        5.4,
        5.6,
        5.8,
        6.0,
        6.2,
        6.4,
        6.6,
        6.8,
        7.0,
        7.2,
        7.4,
        7.6,
        7.8,
        8.0,
        8.2,
        8.4,
        8.6,
        8.8,
        9.0,
        9.2,
        9.4,
        9.5,
        9.6,
        9.7,
        9.8,
        9.9,
        9.95,
        10.0,
    ]
)

_apg_l_p = np.array(
    [
        1e-6,
        8.26e-5,
        2.27e-4,
        5.00e-4,
        1.08e-3,
        1.68e-3,
        2.60e-3,
        3.84e-3,
        5.15e-3,
        6.87e-3,
        1.05e-2,
        1.56e-2,
        2.10e-2,
        2.77e-2,
        3.45e-2,
        4.16e-2,
        5.04e-2,
        5.92e-2,
        8.74e-2,
        1.27e-1,
        1.71e-1,
        2.23e-1,
        2.90e-1,
        3.57e-1,
        4.35e-1,
        5.33e-1,
        6.40e-1,
        7.67e-1,
        9.23e-1,
        1.14,
        1.40,
        1.66,
        1.92,
        2.38,
        2.95,
        3.51,
        4.17,
        5.40,
        7.06,
        9.69,
        1.29e1,
        1.66e1,
        2.07e1,
        3.39e1,
        6.32e1,
        1.44e2,
        1.00e3,
    ]
)

_apg_l_v = np.array(
    [
        2.00,
        2.05,
        2.10,
        2.20,
        2.40,
        2.60,
        2.80,
        3.00,
        3.20,
        3.40,
        3.60,
        3.80,
        4.00,
        4.20,
        4.40,
        4.60,
        4.80,
        5.00,
        5.20,
        5.40,
        5.60,
        5.80,
        6.00,
        6.20,
        6.40,
        6.60,
        6.80,
        7.00,
        7.20,
        7.40,
        7.60,
        7.80,
        8.00,
        8.20,
        8.40,
        8.60,
        8.80,
        9.00,
        9.20,
        9.40,
        9.50,
        9.60,
        9.70,
        9.80,
        9.90,
        9.95,
        10.00,
    ]
)


def voltage_to_pressure(voltage: float, model: str = "Edwards") -> float:
    """Analog output voltage to pressure (mbar) conversion"""
    if model.strip().upper() in ["APG-M", "APG-MP"]:
        return float(np.interp(voltage, _apg_m_v, _apg_m_p))
    if model.strip().upper() in ["APG-L"]:
        return float(np.interp(voltage, _apg_l_v, _apg_l_p))
    return 0.0
